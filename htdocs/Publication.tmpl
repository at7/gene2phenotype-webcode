<div>
  <h3>Publications</h3>
  <div id="new_publication">
    <div class="show_add_publication button_right">
      <input type="button" name="show_add_publication" value="Add New Publication" class="btn btn-primary btn-sm show_add_publication_button"/>
    </div>
    <div class="add_publication">
      <h4>Add new publication</h4>
      <form role="form" method="post" action="./handler.cgi">
        <div class="form-group">
          <label>PMID</label>
          <div id="find_article">
            <input type="button" name="find_article" value="Find article" class="btn btn-primary btn-sm find"/>
            <div id="pmid">
              <input type="text" class="form-control pmid" name="pmid" placeholder="PMID e.g. 24509478" value="">
            </div>
          </div>
        </div>
        <div class="form-group">
          <label>Title</label>
          <input type="text" class="form-control title" name="title" placeholder="Title" value="">
        </div>
        <div class="form-group">
          <label>Source</label>
          <input type="text" class="form-control source" name="source" placeholder="Source" value="">
        </div>
        <div class="button_choice">
          <input type="hidden" name="GFD_id" value="<TMPL_VAR NAME=GFD_id>"/>
          <input id="button" type="submit" class="btn btn-primary btn-sm" name="add_publication" value="Add"/>
          <input type="button" value="Discard" class="btn btn-primary btn-sm discard_add_publication"/>
        </div>
      </form>
    </div>
  </div>

  <div class="clear"></div>
  <TMPL_LOOP NAME=GFD_publications>
    <div class="publication">
      <TMPL_IF NAME=title>
        <p><em><TMPL_VAR NAME=title></em></p>
      <TMPL_ELSE>
        <p><em>PMID:<TMPL_VAR NAME=pmid></em></p>
      </TMPL_IF>
      <ul>
        <TMPL_IF NAME=source>
          <li><TMPL_VAR NAME=source></li>
        </TMPL_IF>
        <TMPL_IF NAME=pmid>
          <li>PMID:<TMPL_VAR NAME=pmid></li>
        </TMPL_IF>
      </ul>
      <TMPL_IF NAME=comments>
        <h4>Comments:</h4>
        <table class="table">
          <thead>
            <tr>
              <th>User</th>
              <th>Date</th>
              <th>Comment</th>
              <th>Delete</th>
            </tr>
          </thead>
          <tbody>
            <TMPL_LOOP NAME=comments>
              <tr>
                <td><TMPL_VAR NAME=user></td>
                <td><TMPL_VAR NAME=date></td>
                <td><TMPL_VAR NAME=comment_text></td>
                <td>
                  <form id="delete_GFD_publication_comment" action="./handler.cgi" method="get">
                    <input type="hidden" name="GFD_publication_comment_id" value="<TMPL_VAR NAME=GFD_publication_comment_id>"/>
                    <input type="hidden" name="GFD_id" value="<TMPL_VAR NAME=GFD_id>"/>
                    <input id="button" type="submit" name="delete_GFD_publication_comment" value="Delete" class="btn btn-primary btn-sm"/>
                  </form>
                </td>
              </tr>
            </TMPL_LOOP> <!-- end comments-->
          </tbody>
        </table>
      </TMPL_IF> <!-- end comments-->
        <div class="show_add_comment button_right">
          <input type="button" name="show_add_comment" value="Add New Comment" class="btn btn-primary btn-sm show"/>
        </div>
        <div class="add_comment">
          <form id="add_GFD_publication_comment" action="./handler.cgi" method="get">
            <textarea class="form-control" name="GFD_publication_comment" rows="3"></textarea>
            <input type="hidden" name="GFD_publication_id" value="<TMPL_VAR NAME=GFD_publication_id>"/>
            <input type="hidden" name="GFD_id" value="<TMPL_VAR NAME=GFD_id>"/>
            <div class="button_choice">
              <input id="button" type="submit" name="add_GFD_publication_comment" value="Add" class="btn btn-primary btn-sm"/>
              <input type="button" value="Discard" class="btn btn-primary btn-sm discard_add_comment"/>
            </div>
          </form>
        </div>
    </div> <!-- end class publication -->
  </TMPL_LOOP>  
</div>
